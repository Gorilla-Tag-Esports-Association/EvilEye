#include <windows.h>
#include <stdio.h>
#include <string.h>
#include <openssl/sha.h>
#include "headers/webhook_handler.h"
#define MAX_HASHES 256
#define HASH_STRING_LEN (SHA256_DIGEST_LENGTH * 2 + 1)

const char *valid_hashes[] = {
    "4D11D8B40688C4BA746D219DB9CC8A09E0E30410301B99867639541E333342FD",

    "A0995762BE84466CDEAFC8B08B4198221DF24192803EFDFDCB8A61DA9BE7C89B",

    "A1653D31CD8C132E4AD1379948CA8EB7B71E3463B082E2B69E245DCE23C1EA36",

    "B2A460CECC190B7B2B12FB5532D3CB9389EE47BB0EB5FDD58A176C12D78B6429",

    "51EF0BBB0A75DB8093BE02D8D5F6A12FD5F9F0C3AB97A2F16BD6AC758C3D40B4",

    "6A359BEF40A5FEFD410A64EC2D59C3CE86FEF58F802F2E4EE7602089BD851C37",

    "92327731D742BF67B899FEA064F42DB1B7E8F298EB8442C5476F987818A4F16D",

    "53864D11298DB8204FE44846F043F40CFA093BF890B30A1FBFE80DB87F5F2810",

    "64C491998937DA309EA112B15F07C59B93F2E0343233DD45F28717752B685B77",

    "7C60F9DE7A920CBDF3A7B2A8EF38106BA1B747F1EE4F2FA63E6FAE650309138A",

    "DF5084C7B6CD6BB47A00DFEDD93CFBF84D0813F7902932BF8B671D96EB586E6B",

    "DC71350DC5115519A9860D3F8D6ACC64805D4A24B8C9A9A60CDB2FB06924FAF6",

    "B1D31404843BEDA68CCD123C3FA8DAC157DD2EC955CB4F7AAA5ED221CF19D387",

    "8A54A63A1EF238C5A44ABC50CE7A590C3C58037CB4FD8E90DFEEFA0F18F88912",

    "77D9BA292BD5EB239484C1F1E4F27A31D24529F993262C40A047A6484F264191",

    "4CFC38AD7D03BE7C5EB1D8CA0DD6E7480E5DAA012FB67201FC85378529D60FF8",

    "98A574F03B8A973B21B3FB0FFF4A1521A5C23294A872A97FAA07C7F955930EE6",

    "9F224DC920B731B8184544B2DE2F75020D03D9A3F63E3195EADC9E8600277CDF",

    "440A152D8F245B5F753C11E3C66A9D423FF16C5EB12E2806BF2C4CE2DC783DAC",

    "0006ECF4B41FA3970411817CA8E69E6511F1C90E4BFDDA61A665820E5EFB855E",

    "C0927A200B8D42BA6693E10BE1DB5C678738651A3930904ADE942C72082F0DEC",

    "37D9A7269036D3C02C742C583F5000D295BF61E51C954A765B75196554B9ABFD",

    "4ACF7C8068F9B865A606E43009D9EF8324AB277474FD77DC972FBC43C6A614F1",

    "C9E6088C6FA739798DFA55EE9DE99586709E53A7F6C753EB69BA974EB3033DD2",

    "CE4BABF245C352FDC28F2A5C222B32B37AEC63B38673C688BC913F489DC9C09B",

    "00FA501B7831ADF84D332B826AE3A99FA64299709B26447E7516A6B733237223",

    "FB9F4E7D5E3020F2A513DA4E6A5E621F01DB396DC0245FFFF961F4B71F76375D",

    "C64D44DDE1EBB97881737F4270D84062F84994680D7B31B00BFE932E50AE48C6",

    "BD7DC745CE8DA7FBEECD07FF8101245971D42BD6A57A1C9AFADFC075292A63DF",

    "26AA4DE828FB1C9DD8A219A52639D4BC9A5333D7770A29A6372ACA0A067491FA",

    "A4DF4D9AF853A7A3AC61C6092B63C51CD1BDBB4C541AC6A7463DF5D207C7FF1F",

    "784E700F699FBE31989862C80E5A298ED78CC9ADDA3707DE1D2B6E6869EB8515",

    "FB679A5499D93325CDDE294D8CEDCCF2F17E3126027FA70680D10A3D30C3932B",

    "4E686DB5AB8EAE44DB1BA7C1029352C79C23D00448DA55CC5DFA79F09EF34609",

    "0B4DF7F29FD2524F28CD2066EEDB3B6210F1BB00148175A90058A69C2DC734E2",

    "14BC1C6D11F5E3C09B18B8DB3DAB52CE6C947A48A503090880F5CE7C6FA5C67E",

    "C80295C88EF51A3B728130E8D42712FC2A46A8340B7A989B691EFE37E11C6D45",

    "7848D44451A271673051ABC4BD1FCBFAF0DB8794A1154F5E4832AE875046ABDD",

    "005F4CABC77A5D9514B15C3403BC51DE517FE3A1065758B1705178042870CC35",

    "C48907C1609B02390821FCBA70F073763F34F6AA979CFBC1517EB3986912617E",

    "24A20EF8DA0E591C40D6A78D97BDAE5AFEB2A7F8F620DC3709EE235FA9CD491C",

    "207840CEB51F168C2D88803E6DCC67E29C4AE2CC98F86E9A2EC8465EFE30059E",

    "12A0F412B4FF4106A78A68E536A252E18ECEA3D4C21695E5F2378D9F621D6833",

    "F57C97057DAFDAD7AE0DFE1E4F16E741B5E84819B478912712DECC34F720ECC7",

    "4659E4073F5F34255344F2E6548D3EBAA33CE010355BF2F704D4D6FD67E1E1A9",

    "22715F5DF9C8E923317F1D8293B30F2192BEEA162D9592A4041C77772B293096",

    "44EA7F731DA00C9CC944862AA9E33E17CE5754E1CA4DBFE30A452F207A78F206",

    "C604EAC356C29B37044F980EA74E22F175F5F3BC26997F5416C2FCDAD2B29644",

    "53F6C05F6F44D6F72148F32E178C1217A9DED4C530AACD264DAE6FB3100F8CB2",

    "51D7CE1B45A7D06AFDFDC2A80D7807A0DF3FB9B45E2C2D256BBF039C4EFB1C8A",

    "B4AACCFDECD2C39E7246998357CA936304418728AD95B1C2BFDB74A316B8AA41",

    "BC7C801FD932C73FA57E73FA4AF6E86A7FBBD1CA86BC93D897D2A44FD12356ED",

    "7533EAF81E6442F0B61C338070E639CF36590D2E1FC27BF038CDEE30320BDD46",

    "22B6B68D81C58D0D41E45D0011896FF62BFCA0FF9C508F0D2872A215119E4091",

    "006CC8CDB4EE886ABAA3D4C464F7E94C221B25A871CCED0416846A6E5A455E15",

    "837FC9F2E32B57EE00187AE8CD579BA56101D9BEEA25D7FF4B7951C58F4FDAE8",

    "6AE62E082DC494A2433984177F60CA4DB5FAE69B1F360A8B33754172B310B8C5",

    "A56146202232958F46BD6A28B5A7DA166AEA123EE0D646735A46E5C341DFBF1F",

    "3AACF6FD874A4E4112E159C0FD291F9CC4383A0CCA4BC2B40876A48E10AF6747",

    "58926C83AE3B1584F8F4FC44CFEC33CDB05E94886620E3FE5CC238B4A4825D1C",

    "0ACBBFCEFEB2588BAF7EBEB4BF7D6AEED6621D37263E34C2A656215BB6A45160",

    "7D9A5185913F3959A06FCECFFBC8FAC875495013B59A795D47B5626DFEA66F26",

    "53CBFEF2FD856C5A86B7D95C1D64F1A326AEA95BB804ACEE1DB65C42C753FA40",

    "0B44EFFC4270309BFAA5186BD45C6BD92A4D3A53F9B6DC3AC3921F3A77DB45C8",

    "0D9C03D2D89E549664335D05E95489514636B402AAC4035305908B8DDDBAF8E4",

    "7B3CC88E8289CBB80C90988A4463E6432A263A4B94340F7B84472030BA12FD85",

    "E868FCA7A9A40E9367E9D1CB45DCB37F9E60BF0449B3CC8A4A15FCAD0D31657E",

    "ACF8B669F7318EA7C41C36D230334AFFE652A85C829AFFB0A966B883032C0B65",

    "43046F35256D9C58A5A520CEA2441D8674B55866AB30E94A18DCE3D7EBB8A316",

    "5D57001675EEFFF7FE8D80A2EA6A898D316D2D353539BC8F0E951657B055335A",

    "4651EBA68167202DB81C212F445E23A2742560D70B605C0B367AD26A4D8DC1B3",

    "481CC0F9A53A9BA94F8EA3FC0FB2A520B41812C2FDC6AB10581751EADA743D34",

    "6D37C20001D050B2BFD5071D64EE19F7FD7415E021E8122F1E9070613E4D570B",

    "2DC86BBC677DC4EC111F5C5CBF85A037B530AA2E4CCD6E8DEEA58201B4EFC530",

    "6DFB026FBE5D49203561ECD49463C1B7AC59C7E3040E28F128D38948ED9C90E4",

    "319F8A9ADA4DE3464D095A04FAD667166B23D92A5A82EC04D5C080A01B4E06ED",

    "6350ACE28EFA370A25B2174A06C3102819BDDA3C5452D64BB724BA843333E851",

    "EE0CA2D18029D0005DE0537CBBE82BC4A3A4333C322E7B0C907546F6D9A22823",

    "7B2480A6EAF534559572A1171F9E5330B21BCD086DB24E12655E32B9C46CCF92",

    "331A5DFF4F45F37C156CB2454E197F9886B5789B249C9FE127A6B8A00EF61B1F",

    "9BA4F9248E5FD2489224CF7B02F59DD2C5598E3EC1DB915742F17FD507236166",

    "3CE666A009120B5D8C4F3316EBD5D387147364EED727A9B10178AFB909E4CEB4",

    "2764E855F56D11C0AFD8F84A5E29AD62D9CD94E05B923AF78686191DC17CEEF2",

    "89BE674D88AE226D2F2068B17FC7DCB52D716D88D44C5A327490D966089071C8",

    "5FF85A7BB62D571A21BC124BCE175E5DB451F52F6BD70751371CE2AB939D2458",

    "EE2F7F2B0D6F87E989D3901A2813FE747C20620BAE68B136AED594C3F8F1FA8C",

    "E04FDF07E94722512C56E922B26C5B0F31E2B2E46D3BDDC3D25B448D119E4E7F",

    "E743FB3D8764B580344F4725037FD7A57C7ECC7E613EA5757F30CBC797C65CE2",

    "5250334C8AF57A92690DA69ACB662E665AB8001D02CEB38C5010B28ECA93C9F0",

    "6DBA4706FDDF2F0585BF6E0BFE633150346DEB98BCC7E07C76200BAAA972DAD8",

    "479C1B0C9802564BAB95D2460D9D70B9E8242C4BF81D8733444BFCDC6C8F77A2",

    "1C1C0ADB5AC52E6E54F80DD9129ED2C336009413C88DF3AA605F10A08B65D147",

    "A286FDD5BBB7DCB96B622AE02D22B2323179233347A2C49A70BD9B46931F3224",

    "E205716F9358C12D3C4EAAD03E4DAC2FB0CE495C3BE79DA4A381A2D000E5AB6A",

    "27E2E5493513D197A85D2950213FAB71E278A08F59E1845A8D16671D4E0E9E35",

    "BDA87A98A3AB0037D195F59070449316C0F47003C69A0456187A5301B7D6B712",

    "C22491B5F479854DCFF83C32D6A5C4278055686A8EBFC6F09E8B69E3632E272D",

    "C08C75D088297C0499B9CAD74ECC3AD524CE7B8F491DD07114C7FE5D06A90A2A",

    "01748200F2400C742AA689F1F5101BD6298EFDFD92C00C18F4FA473847235BA9",

    "E0A7334B7BA419AAAB6BD3BB6992D693E689341A9178172C9BF99C2AA6A085BD",

    "F4816491F8B82C471C0304C0A32371A573DAFC1B9BD28932259108AB9E4E11CD",

    "182A1CFC229D43C63D6DE9B6A6D6DF6D92F07368C840334375D559A784187321",

    "5032DC630B32232EA74F9B188A6652B77EDDF5535DE7890CFAEF4D5BBF09C740",

    "71A9E99E1F7F0259186162B8D5E118FFF58AE28FA54DDE822F6425BFF7C32120",

    "A4A4819F960B4988BD12239A711C8D5EFC3F4ACEB3B106EB3F50F5C861FB7624",

    "F675068ABFD171FFAD95BD359702DB2CC9D4EDC8C39702BC596682543A88FF68",

    "506CACC82972F20EE8AF582023F962625D5BBE73249ADE78F67DB974DE777755",

    "DE4B0195BEF8D210B4C26614A8181CE7E2CF0582AF8F0850D201A217FB222F6E",

    "1D3FB7FA60E176659376BBD27069AC34321E71CF1742FC6A1D1593D9810EA2C8",

    "0749BC808A3F66B5EA040A09FCDB98E4FB2F6D7F6F567639D7CD6909F54F0AEE",

    "B7EBCF3F01ED4D09C18A04E41329F15D63B4FA3B579C6DC823911E4E0EB05831",

    "909DCD7E6DAB8A53E9DD180A8A4A4A4C15C699FBF59A5F6E885335B2589038E1",

    "9D9C1FF52411DECBEE5D9F0D1CD61EBEAA222077AA77A52101EA3DEBAFAE98E2",

    "D99D9D5CB0C23FEF160E7AC30F22AA3D2D601A416532D2ED0523D432A749C3CF",

    "D39E0793C631BDDEE6041608A755AAFC1E25B124EBF4BF722A5EA500185F0E58",

    "CAB2B198C0D2CC72C7DCEC1CE34693BDDC20D00BB2AE9DACC1C36983502C3E8A",

    "90636873830B5FE23ECECA8176ADE07233BFE8FFDB57DC2028DC464ADB46FDB3",

    "8344E3DD55314D6A133EE589AAB080D4EACBB721BCA82A1F2CD84F906D4C69D5",

    "0101D8CB8B4E020782B32D510B9FF1EE32524A27F9D15122B299C8344C3A90AF",

    "AA066FE90D850B7BAF4EF7AA26801B1B72F123FC134B732223F96E4E313EF1E6",

    "EBC4CC21A5C415F5935EE16477560C8276B0E8038D0AA9612343A50FF771E65F",

    "E3B9B7C30FCAEB473D1C5BA6B40C0AE8AFAA65BC3900AC5FFA3B8A27F396355E",

    "7C2FCA6341D10815F6F085DE39B3D5A72CA41467F146EBB6F1D810CE4EFE0909",

    "7438BBABD995F2DBA18053D7BCC817C57B57A00045702B7A52B65B285BB7EA05",

    "3613DA532B548C560A291687BA0F5A35901F94229B5075E6BC3647054D0D6D21",

    "F5CBCD89CE6AE2610FDFC86B6590BC30A96C6D6E6C549EF83F6F13079EF31D2D",

    "A4321252F205D98485A5E6D7F9D491F9A851124ECC87C29B5AE29D952DAEF8FB",

    "4FD425BE433738879BF1B26A176CFCC22EFEA0ACB83160F999E8B4DEDC3522C7",

    "D3D9A1540F4870C757BDAF201355123989FA9012714A3CCC3AAFC9BB4A59841B",

    "E0FFD05740812FD14CC9D3F8A63C1ADE9E0FF9B2FB254AC97393031EB2577AB8",

    "DF6A445C9B4FEA73505364EDC5A1C49A82952EB0D2567AE74B956B2874E17EB9",

    "B3AF86A467B914D06FA8B5801957CB62407406027B3F7905DF7A5D7C2209F2E6",

    "29428F8E7F318809206CAC442B12C08297E039A4743DA9DC0FAE0DDC3343DB5D",

    "EAF49D527ABC73DA0995FB7754747DA7E4AEF57764B20D6FF4B995B141137866",

    "E319F9FED8DE902E9FE70D7F1F229255CEE0890BF5376E3EF0F5DA13B810F054",

    "0771754584D6A4B6BE35C374F9C61077B24582F561E54167DF17A9C88F7A6A7A",

    "0DC51D045CD53387DCB0B71012888A38FE63B2624B9BB6C7708386D840DE9211",

    "86090C526D87F32602D2DD2D61F46A9C70E9B161BA431D9DD9C8ADB779B06904",

    "E7738AAEE77EF7B077EB5247B27E54C68D033FF7F2E343E70042C7190850BE01",

    "FDD33F0BB510FAA7A09016AA32719938A27FC53DF34C96EA72C0F9B24A07C852",

    "CAC15133579D1C0704CE1AB6E082E38F13AF2902F968FB80279043CD78257B6F",

    "5A21CFECE54ECB6F647A82B2717501C7F0D5AF0CC474B24D86AB5B9ED950DEB8",

    "F23B48F5C5423CEDDA10FCE0E4AD666B8B6484CBDE846AD31AA6AF9D8BD28307",

    "B8824A33A59C6688B8699936F7766AE204D7C36A5F9C5E9F3E4D265FF5615FA7",

    "50036B581888EC5124E8E79282413B55F9D11B8EB8EE791F9F7B4C8C1D1C9D02",

    "E9DF6CCB02A836CB84C88511C0CDA2BF2D00513A867D3EF8C06CDBF68B5F1BA1",

    "2F7BC3F1D062B0A645757A4C9E65DD4D055CDF3CA3923039A847D63A78466D95",

    "7D67D19B3C0376DD72C954BC5B9A2953F04AD21EE842319387A7CE0BF5F37B5A",

    "74CEB8ADD399701CBC9D895E5945C3F0855B37192ABB43D52B53FDC4355205CB",

    "FAAD656AE41C9EE21D547F1769F9733D7C917606C633FD9710373F6908074938",

    "F654C1E360E16824903DA29B96B6EA373CA0B80BC5B03A5D002F8E0F684616DA",

    "5AC7A1D6945DA1FF4EA68941916FFD8438979B0AC323270EF286F6656E2F69C1",

    "5FD84A6B2B877F95A3B8D996CFD143E1F2FC7B11AB9FA8BB250EDEE05A844E8B",

    "68E60F3C8ABAD9EB1E5C75525B7601B502C1A9695CFDC8374F9BE2CE176E38C9",

    "22F4D3E3277701576E9F46C3F7274577EDBD12806449DB95CAEE75F7EAD0D1EA",

    "DB92BFC61C4CDE131C44C4B5707B66FB83E71D5BB71F9D0B42DDAC68639E3EBE",

    "16A82222B33F4A76B7298657F7818885E19F024143953B90A110CD19DE441089",

    "205C287ECFC21F09477B77007B153C7C48FBDCE428D6A793839115E02F93DE97",

    "1C3345D1FB442757B825BDCFAB796637483974874749B4F72FF77EA8D6285160",

    "F1B644182D10E46FDCF96BD4582EA28A81B0DFAC1586BA1BC9909A8FCA799A78",

    "9AA55999A40E32FA07442384F56EC438D73A2D81C31B81177DEE7F18227CEEC5",

    "F8F7D5D5BFEF6CFA1A6BBCA6E9470B2F5CF5797FB43A739FB96691ABEA306121",

    "D37FEC6496BFCBDE28EBE9A4BBB9575BA4859FE270D0272B64809C6332B83AC4",

    "E0E748AD00E9AEA718F88AFF83060D9C2B8A0A59C37C796461C26D3961CD9A4E",

    "7A3AFA78C04F3D14CB501DC5F65BB5E6716DC430B299D794AD1B9C39F387D048",

    "ACD8C7C81B27634D9C654D48A1262D28AA18C4E8A7A9F4EE7EE01401A8133F24",

    "39BC494B3279B312C71D468D8A474D004666FDA1FCDF7307E7DB1218972301D4",

    "D8CCC5593158FC705353E9508A63913770F3F8E16391F5E34DCD4814379A1711",

    "43609A1FBF51B5270ACC485779B198D34483B77BB3AB5BC5942CC2CFFE45F9BD",

    "F4BC98CB643E55C96FF8BB51829C788DD2BADF93367240AFB579782E689FFE2A",

    "1DD41C4AA825F51868CF04F2E305DB858B462044528DD729E7B4818AD53D8C75",

    "38B2E39E8F9A663BEF9C2E4F77F184523AC113EB9081E357011CCB40C7436E83",

    "343B86DC7B9BCACDB530B759A0387D24980B804907C6872D62933007A34EFD30",

    "A8E751F96A8A14DAB70FC8FD3D5226EE832751B9C0E8B6FDEC129BCC48B315ED",

    "AD2F7F939C1941BC6209FCA347F64ED533756964411009B6B253FA94C9AF47C9",

    "6E698BD7125EBF35B82DC3B4AC23C28B60FC04B818927B89987A2F2656D623F6",

    "D89E70E6AF40BCA2683C9CFA418C42A7A584AD6540934E3CA693483E5C6015AA",

    "D181977F02E488518B42F98C11BCF70327E346FE6FCB328576D0167E98DA3A28",

    "E046945C2E3E3B423269766AEC32EBDA6FBA4BA5D64E9246F898B49BD05EB810",

    "0509DE8FDF43E38FB5F872D9425E85D7FE15969FF8C47412164BE4A4E32C52D7",

    "20CA47945CD90DFDE4EBC7BB52A2F184BB1A2F89333D51360CDEC6DADAA56E81",

    "AB1F99203337002F1DB5B259C897A8250C5FE04FD7DD7D32E4DA49D8ED4547C6",

    "025BDBBA4843943451F012C664EF0D6148DBFE607BE2CE7B2789E965EBC4CF69",

    "D60608CFE58AE7B189960C2C966B9D229C4C1CAD40A879F7D11BCD035A29A47D",

    "A6D6EAAA0D48E0CD99C5D6A7D15A516425ABEC5D5CC499560EB528886FE50A58",

    "3B4057E35CB03997E34A498B9C93BA4537E09483E1D332AEAB72127FF246B42F",

    "274B14EE4D9CFD426938DAB84D088AED08146196BB17FB452EADBFBAFF01EFA3",

    "DB9FBEB2F373EC46F5AEAF9D43F77BE32B4EF0ADFEAA51ADFD314B7428033E2B",

    "26E663ACEA301CAD32711F25E8589A882B15752A180058E265CE32B0FA29B670",

    "469915F4DA89F3D066650408FA0FE47B78F4934A1DA8C6BF5A975C40ED1D111E",

    "E5DADD90378587E9C4A9AAEDE6DFD1BBF4AF00811AC7056FF1B6F406A8F576B8",

    "9E94CFA5CE0800E43F1160F396C9902BC56C62BF62B6EB2102A10975CD09C523",

    "3125C4D1FF76629AEF96190364C938D258CBF84408F36D08820D9BCAD6162A06",

    "E75B18AE5AD1FF71833BEEB579A82AA3A6AF0C78DE283191816138022F06AC65",

    "042F9B07BA244B57DDA36123F1E9978BCCDC155A0D18B5A9EFA7094B5F86D114",

    "87D77EFA870EAC6CCAA13903C27C6D220F1285DCC51A4A452CDCD69DA7080883",

    "9D643A070AFC0F1924ED5FBD5DF9CC1808458B7A0C50C5F34118EAF04E8B706C",

    "B61FC5FDD656D96D4D9D110E6EDB0F7C5DFE2386DD7EE976F8A92FE7561F17B6",

    "B1CC3CCA08D51B6C9BBAD9A3434FBB717D6F1CCAA8D2D0353B1E5A3C37A3A0C0",

    "DF4F34630616FD49D5CC1A44833418D8C068AC0AE28BBCA77C0B800A09C8E57A",

    "15A9C1B2EC519346C9C84F9F9B023000A9DA2143FA5375F445CC277742D54494",

    "A6A518EA56E0C5F30911D98D941CE9CCAC7190EF53E539CB752123D098081182",

    "010D7B430294DDCA18538E3571B3359A92680A3FB32598CC263CCBEECC9A7382",

    "FC113290F348E7FCBC90263496DCB30E73F2F36B66A1E8D028F685CDA6E3273C",

    "CD3B7D591C944BC72F92D730DF54E1F826729FE79FBC6ABFA32C0AFA4958E96C",

    "AEFBBB36DD882A83308F2CDC6F3EB41C68147D8083AA2E0B838AD9FD3C8AF998",

    "81006D660875D2AB1D3EC5D5F6992894DF7254C2E697D9361830F972EEF3628C",

    "B794A3399388591BD4F5E4B593F6E9E5C077099F1B20FCB78E96D99F8A37058F",

    "382FCBFEF21C970F25C959F22F436DDC42209AB2D83E4770B026C9D952AE85E2",

    "11F6306BBFCE866E730EE49CE77EA25CB09BA8F9BAF6A8B43DA41F8204B94740",

    "2DCE3D3BA5C800B99AFC4ABF3EDDCBB2889B448AE46DDA41867F74CF270723B5",

    "B932F9475800BAE00AC8FE3F428E141717562406126ED0382CD87A132405D268",

    "C2CB12685B1D8EFFD455EE4C86DE895A1C57647162A891184B7FACD42F41514C",

    "5C0D896B41DE72178ACE5E3FCE9F7B74977B3504BE3727FA3B495166ECCD3EBA",

    "4C17C349CC27C674CFA8D986EC3134451E55A46F7E8EB0F9C58C95C43C3F69C0",

    "E1E45398BFDF2B0043EC922B0F008BFE27F2A279D664169CD366D1B3D738F518",

    "323004FD54AB0A4DD68C9D7F67FD75AFA736E2B2A349CB9CF957FA21F25D6879",

    "E57B964EEB264945C4C133912A61FBBBB793D697B5CF76A5C4AC97341A2659B2",

    "577B678E41F1233AD993561192BA1DF0CD12637A99E36C1D901137980E6C12D5",
};

int verify_int(const char *hash_str)
{
    for (int i = 0; i < sizeof(valid_hashes) / sizeof(valid_hashes[0]); i++)
    {
        if (strcmp(hash_str, valid_hashes[i]) == 0)
            return 1;
    }
    return 0;
}

void hash_file(const char *file_path)
{
    FILE *file = fopen(file_path, "rb");
    if (!file)
    {
        perror("File open failed");
        return;
    }

    unsigned char buffer[8192];
    unsigned char hash[SHA256_DIGEST_LENGTH];
    SHA256_CTX ctx;
    size_t bytes;

    SHA256_Init(&ctx);
    while ((bytes = fread(buffer, 1, sizeof(buffer), file)) > 0)
    {
        SHA256_Update(&ctx, buffer, bytes);
    }
    SHA256_Final(hash, &ctx);
    fclose(file);

    char hash_hex[HASH_STRING_LEN];
    for (int i = 0; i < SHA256_DIGEST_LENGTH; i++)
        sprintf(&hash_hex[i * 2], "%02X", hash[i]);

    if (!verify_int(hash_hex))
    {
        char description[512];
        snprintf(description, sizeof(description), "Invalid file hash detected %s %s", file_path, hash_hex);
        send_webhook(NULL, description, 16711680, "File Hash Check");
    }
    else
    {
        send_webhook(NULL, "File hashes are valid", 65280, "File Hash Check");
    }
}

void scan_dir(const char *directory)
{
    char search_path[MAX_PATH];
    snprintf(search_path, sizeof(search_path), "%s\\*.dll", directory);

    WIN32_FIND_DATAA find_data;
    HANDLE hFind = FindFirstFileA(search_path, &find_data);

    if (hFind == INVALID_HANDLE_VALUE)
    {
        fprintf(stderr, "No DLL files found in: %s\n", directory);
        return;
    }

    do
    {
        char full_path[MAX_PATH];
        snprintf(full_path, sizeof(full_path), "%s\\%s", directory, find_data.cFileName);
        hash_file(full_path);
    } while (FindNextFileA(hFind, &find_data));

    FindClose(hFind);
}
