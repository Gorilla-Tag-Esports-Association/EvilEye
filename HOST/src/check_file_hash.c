#include <windows.h>
#include <stdio.h>
#include <string.h>
#include <openssl/sha.h>
#include "headers/webhook_handler.h"
#define MAX_HASHES 256
#define HASH_STRING_LEN (SHA256_DIGEST_LENGTH * 2 + 1)
#define INITIAL_INVALIDS 16
const char *valid_hashes[] = {
    "7546DA72C906B053D73E4E984EC3C3AE63E8B2BD800AD3D1589A375D6693DE1B",
    "BE98C5A5F777894EE3109BFD1862736D9262F941149FF44A31E19B36775DD411",
    "5B07B2BEDE876236AC0C0FA0A6B20D77B92A7BB004AC0241370322EF70E7B392",
    "5644A95B016393786E65FD13F93718CE60206EC0EA2697AB3E87729302345A54",
    "BB514F2BC9C66D46D7B9A38293598B1EFFF516264E8A148248A97726DA51FB6B",
    "57A2F424ACE4DAA2EBCA62967F5E328D0F033E6D25EB949F3C362F87B6D32638",
    "CCA6682D7EBB74D32A1175A45590C5FC1072DD5B4084D102685EB05CF73B70B6",
    "99A23D61FE26988EA9D4CD279C6DB69E0F821B2E37728E94CB4FD03CDCD3B97B",
    "1A67DD5F3358A4C948805B6966F7439DCB342B8FBD7ECAAA5D8E9E03B7212D46",
    "74D93BC4C48A04084CE2EB557FBDBF4A28E41F60E05C71E60C94729237A535C3",
    "A152DB3A589BC32488BCFB73ACA111BE2208187FDBF6D2F22CF66B4E4F95BFAD",
    "DC71350DC5115519A9860D3F8D6ACC64805D4A24B8C9A9A60CDB2FB06924FAF6",
    "E38E0A14471A8F9DD1E570B0019CE56820782FA59C65CBDAFC3D579DA52F815B",
    "C900E46AE9B5624876D72C4E689EA793292ED39944837381CB10D07871839264",
    "77D9BA292BD5EB239484C1F1E4F27A31D24529F993262C40A047A6484F264191",
    "4CFC38AD7D03BE7C5EB1D8CA0DD6E7480E5DAA012FB67201FC85378529D60FF8",
    "98A574F03B8A973B21B3FB0FFF4A1521A5C23294A872A97FAA07C7F955930EE6",
    "9F224DC920B731B8184544B2DE2F75020D03D9A3F63E3195EADC9E8600277CDF",
    "440A152D8F245B5F753C11E3C66A9D423FF16C5EB12E2806BF2C4CE2DC783DAC",
    "0006ECF4B41FA3970411817CA8E69E6511F1C90E4BFDDA61A665820E5EFB855E",
    "4F6D5E2CD702FCE7A0EDE252612E237D607E3A419C9278E1A31085BA00598557",
    "C7EF450EAA4049DB517BAB6320F1AB284BE49A59F0FE68E3838D9444469C45F3",
    "84BEFE706339AF4DBDF39D89A0012094BF135401F6D79FB6034B8566794F399C",
    "C9E6088C6FA739798DFA55EE9DE99586709E53A7F6C753EB69BA974EB3033DD2",
    "F07582A17FFB48757C0B1DC16FE5D6F80910706A8D4D5A24358E6508E8130695",
    "ACABB5A4A7FCC6CE1B43D3D2C669C1FBA6C44B05517BFC7B025AF663E0E0BACB",
    "D0408E1F2046F4125E14F723A8F9A6E8E0BD9A2CF9EC03340C5FF6BE612EB681",
    "A13E8E235D0C69291F279A52C85BAAA527AF95B98E61B475D18A29237B55045E",
    "651B061E5DADA7AB2A9630ABB7326F58F02DE67D6D8812A1AF105849942ABCF7",
    "9422F200666364342103A2DE29A5B3ACDCB5F3B240142CC2A9C1B698F5C955EC",
    "C09CE6700C37EE84D163633CB66DFBB54F33C2DD795C73AC087CB32E5AE3653B",
    "FCC45F7EBF3E4A70414813006E321BFC64838EB291494F2CF183E207D407017F",
    "03A4D96D3BB11CB4F35CBF2AD5C1EBDBE01D33D7C30571D82C2AAA8FE33A0119",
    "E31F13B39850B0214CA4935DCADE92FDBABF1F95D4D855FAE7E056FA75477D96",
    "56DF316E11252ED271B36796301FB2DAB55A29DFFEB4737F820C9271B23A9324",
    "3D0EEB68687986C4A074D2CA64A084658A4D9FBDA9AAC6F629A7B0C215D1484B",
    "47FDDD8985AB64B796C408F1131270A898574AAB10C1EB478159115C379B85AE",
    "903E4894FC642BEDD48539547E9C615CA75A40D990019053810D66CD85B86D2A",
    "855C582E9351096742983A84C56587D27462C80ABF9E25E9C0AE563D17CAF5FF",
    "BB00C44A209DCBC5F63F7DF47ECAEBBB6C4E3309C26C74BE01D666EB427ED260",
    "82014730A81A3FA13C8BE10A6927D59754D35CB5E197DD404AAFC0E043AA57F6",
    "684C1DD65843A898B04049898A3216483C583009FAB47D33719CD28022276A4A",
    "96DE3B71EFC74850848122576660AA877F322F2CC403E643893F7177C14F4222",
    "C26B8012C28DCBDA121AE43C51A7ED3F0D6538F3EDEB55685880A187EA3C0FD0",
    "F44406A7D2F700DE65692F0739570BB0660E81F3C3785B5A6156878DA165573D",
    "F2A922DC218E21B153C85CE20C92C11772DFD5442CF1CF3E3F8E3C4FFE36083D",
    "22715F5DF9C8E923317F1D8293B30F2192BEEA162D9592A4041C77772B293096",
    "44EA7F731DA00C9CC944862AA9E33E17CE5754E1CA4DBFE30A452F207A78F206",
    "EC93A0CC6DF270AF8C50402F843DE00C34FA7201BF11B72FC3EB3E8F19B326ED",
    "53F6C05F6F44D6F72148F32E178C1217A9DED4C530AACD264DAE6FB3100F8CB2",
    "51D7CE1B45A7D06AFDFDC2A80D7807A0DF3FB9B45E2C2D256BBF039C4EFB1C8A",
    "A26A5CD6EDBA2050A2873F8D0C36A8C16B94A4889021D6A5834642F55BBAEA3C",
    "BC7C801FD932C73FA57E73FA4AF6E86A7FBBD1CA86BC93D897D2A44FD12356ED",
    "7533EAF81E6442F0B61C338070E639CF36590D2E1FC27BF038CDEE30320BDD46",
    "22B6B68D81C58D0D41E45D0011896FF62BFCA0FF9C508F0D2872A215119E4091",
    "1622BC0A8DC6374523E8E4CFEFC06AC295AF5B9ABC95C965DC61F9EA0CDB431E",
    "653D8C0F45F1994D84F136C8FD44B3E769ABA9DC7573B840BCA5FB523FF746E8",
    "6AE62E082DC494A2433984177F60CA4DB5FAE69B1F360A8B33754172B310B8C5",
    "A56146202232958F46BD6A28B5A7DA166AEA123EE0D646735A46E5C341DFBF1F",
    "2D0CF9A5143127A95C69650F02A4440CD525CDF246647F6BB0F4CD32CFC74C66",
    "58926C83AE3B1584F8F4FC44CFEC33CDB05E94886620E3FE5CC238B4A4825D1C",
    "0659D3BEF0728BEC3DBF403171FB668754CBC416F545A580AE46A154D4DCF256",
    "FD1FD0BADF240BB79977949B4018D778AAC142B695080907EF67C472ED7EEFF7",
    "908377E5D8300DAA0077ABEA83B9A5CD735ABA134A61D3B911E607A146D642AB",
    "FB2292103644085E0B9552A25F5FC9CE753A9531A2DB426EC64414D1856FAED9",
    "14AFFAF74E99F7A7A58A70BBED1427E05570355A27A000AEC69B62379C489B0E",
    "4CDD7644383FB4336659AA5250D37C3A2A79E9829889FFE6CD4F3B28B1803CDD",
    "D84DA3B255FE95159731B29D8B7D9232FFA41CC73250B8C1F010419B5151E19A",
    "23806C28BFBC49ECCFFE4D38A664B148641BD1B6334CE07789913A81273C8B54",
    "3DE4FEEEE6D49F72BD9D759311B91EE69D6EF0ADBB26090EB414E47E3987AE76",
    "7D7F83646426ABA536ED52F996E3F237A91DDFC9250CBB784680136CB3A34F86",
    "4651EBA68167202DB81C212F445E23A2742560D70B605C0B367AD26A4D8DC1B3",
    "481CC0F9A53A9BA94F8EA3FC0FB2A520B41812C2FDC6AB10581751EADA743D34",
    "6D37C20001D050B2BFD5071D64EE19F7FD7415E021E8122F1E9070613E4D570B",
    "2DC86BBC677DC4EC111F5C5CBF85A037B530AA2E4CCD6E8DEEA58201B4EFC530",
    "394F4C5119A5C605D14789845EBD81EF1992AD2439BF470AC8484E80C13F51D0",
    "3CF7883AB3146586AC4BC32930DBBE3EE5225E65D284E2C8CBB4E58DBADC11B3",
    "ED0608B6043535D0BBD6014E4B9895F1259729789C54E93AC40779C96440E5C1",
    "92836316DF7EB35B8CA814A368AC5FDDAB1DE3A5EC004FD06566946ED75A8AA9",
    "CCDF2459E9F5DFAB90AF8019AB709BB874C2222F273819819A79F9714D69017B",
    "CC1D56B90852E716420284AFA5688AE2B20B95593456792EB2AFB3C16DEC69B7",
    "329D2E42B210EF424C9E331111AFF41638719E9694830B6711F4899DBF2C5922",
    "372553358AB7A294EAD124E80B89C1FD0FE1A42A5BDCFD9873B18CECA3DAED08",
    "2764E855F56D11C0AFD8F84A5E29AD62D9CD94E05B923AF78686191DC17CEEF2",
    "09EA413DA4F236079A85B6083C64069F952CF6AAEA1EDD1FA632736F9215E53E",
    "60B538CA5BCA677659AF89F8A84A3F4F4AF8EA39BF849DA36F05457222573002",
    "0D3BA94A0A29EC190931A0E6AE58FBB6C88EC593ED2659D9DDA8EC4E8CF49503",
    "E04FDF07E94722512C56E922B26C5B0F31E2B2E46D3BDDC3D25B448D119E4E7F",
    "E743FB3D8764B580344F4725037FD7A57C7ECC7E613EA5757F30CBC797C65CE2",
    "5250334C8AF57A92690DA69ACB662E665AB8001D02CEB38C5010B28ECA93C9F0",
    "6DBA4706FDDF2F0585BF6E0BFE633150346DEB98BCC7E07C76200BAAA972DAD8",
    "479C1B0C9802564BAB95D2460D9D70B9E8242C4BF81D8733444BFCDC6C8F77A2",
    "1C1C0ADB5AC52E6E54F80DD9129ED2C336009413C88DF3AA605F10A08B65D147",
    "A286FDD5BBB7DCB96B622AE02D22B2323179233347A2C49A70BD9B46931F3224",
    "E205716F9358C12D3C4EAAD03E4DAC2FB0CE495C3BE79DA4A381A2D000E5AB6A",
    "27E2E5493513D197A85D2950213FAB71E278A08F59E1845A8D16671D4E0E9E35",
    "BDA87A98A3AB0037D195F59070449316C0F47003C69A0456187A5301B7D6B712",
    "C22491B5F479854DCFF83C32D6A5C4278055686A8EBFC6F09E8B69E3632E272D",
    "C08C75D088297C0499B9CAD74ECC3AD524CE7B8F491DD07114C7FE5D06A90A2A",
    "01748200F2400C742AA689F1F5101BD6298EFDFD92C00C18F4FA473847235BA9",
    "E0A7334B7BA419AAAB6BD3BB6992D693E689341A9178172C9BF99C2AA6A085BD",
    "F4816491F8B82C471C0304C0A32371A573DAFC1B9BD28932259108AB9E4E11CD",
    "182A1CFC229D43C63D6DE9B6A6D6DF6D92F07368C840334375D559A784187321",
    "5032DC630B32232EA74F9B188A6652B77EDDF5535DE7890CFAEF4D5BBF09C740",
    "71A9E99E1F7F0259186162B8D5E118FFF58AE28FA54DDE822F6425BFF7C32120",
    "A4A4819F960B4988BD12239A711C8D5EFC3F4ACEB3B106EB3F50F5C861FB7624",
    "F675068ABFD171FFAD95BD359702DB2CC9D4EDC8C39702BC596682543A88FF68",
    "F36FC9ABA4D186ADD467335A879A0A01E72E3E08CE89E24082A41621A0B95843",
    "B52ECE2BF82AFBE9B5E378A25248A715F6AF3357E52891ED3298178F4C4542B0",
    "B64D0A9BF70C4AE0825E496F5CA1138EDB5216580861285A6EE9AA99A6814E31",
    "32B61CA152E51DAEE4BA0C9D146153027A3261A81B5F5B734DA74E4FB86585BB",
    "B7EBCF3F01ED4D09C18A04E41329F15D63B4FA3B579C6DC823911E4E0EB05831",
    "909DCD7E6DAB8A53E9DD180A8A4A4A4C15C699FBF59A5F6E885335B2589038E1",
    "9D9C1FF52411DECBEE5D9F0D1CD61EBEAA222077AA77A52101EA3DEBAFAE98E2",
    "926D6704EF772EFA66BE2B996C83B19D652B906F325DC8127447F2456A0C038E",
    "D39E0793C631BDDEE6041608A755AAFC1E25B124EBF4BF722A5EA500185F0E58",
    "7B3D500409A7C41D4A4E8A60C2E63B235BE9D2A565A511720AB6F430BE82E0AD",
    "15F4C361D9C4C50FD699F2E898FB38C33B2DDA19C39F7BD55D3036A74FC62895",
    "DFFC25694097446ED7472564A703573384AEFFB9A22EBB8CFB4C3AE5C0771BEE",
    "D72D546E63F108664BF382AEE856B2594614BFB82806246A4E9E928D8B1C08C0",
    "3848C7BF5BA03C04B9F5AE1B077FC19738FFB2BE6681B201768834601E863133",
    "A5CCC38E31A992005C603E72BFD7712FC7D38C9F7A7F1593AC3E93E35E038102",
    "F2D5A4E4BFBA6B8771815114CEDC8B4CE1FCBA3C01D9D6C10EB484BD93131E78",
    "14C08EFC0C19D4BB55F598F2681973DB5BDCB68D306DBBAD86C903D6B61E9105",
    "68E7D43923944D6EB0EDB89819990D6E2B2CB2E1DB090474F3C9EB414D859010",
    "F7FD6176D309ABE09D3189357F4E1709CD0EED059CBD1FCF61C5A198D0088AB3",
    "CFDE129FEC1C5C25307BB9F52B43D5346CA135F426BBFC151E4C5CAEFE789102",
    "D3C31DF8D0F606D2B7CC42D282F308AF069A829783682E7A0813619A6B0AF5F4",
    "2017B6EE31C285D49652B2B6D5944C94E89966E28F9B3A7E50EC494F3CE80BF8",
    "DB6FBA752F0D286A59490B584467E1443840B776EEAAF1CB949A20746EC319BD",
    "22E485E9FC1605ED60AC7BAE173E79B6C46336CD46B17A4D1FC738CCCF38964A",
    "650FE0DDAD657CFDD820812E12A184B6052EC4DC69B3EDF770F3AAD92F6B34EC",
    "BFAC1AA9E4916975225B06C275BC6DD77572436990ADED029B45BBB0D90DFF88",
    "34386B9446D0BBB08E5FABE6705EF1CDFF09B4B346F876B1EFD840D47F94632C",
    "59BA4CE6AA29C6DEE79DDF7E1559265CCACB7565EA4F1A37832C0F50DF2DE7ED",
    "EC9A2CCFD713FDE82D6C0F62F92F6A63A4FEAFEDD893AB8C4F8AE6F494017C62",
    "55D07DAD879DA1DD9082B6A1ED0FFB24466A1F96C2DB68AEDF2767B6C7103AE1",
    "3928C8924F0EA3F91ABEC287AA342EAB061FA896BAC2C381A08B704DE183BF6F",
    "56689B818F5AD0882ED41C6B201CA65976F0BCE19A1A9A0B1DC0D323809D4577",
    "517609A51BABCB347CCD411F576EB8B0363D2C8B7DA2648C9A856207A304D89E",
    "5AF2651B486103034BADA56D6E4D0A5E66DC098BBA3119DD866E8A238F3A1525",
    "25415B503A0956F2E53A98E77E1382B1BFD4A8744312FC4A5F02F28BEAEFF3D0",
    "F7B86C5A34EACDE1713C1000303FE9E81C065F4E6FE6B524D34EC447EB14EB91",
    "F23B48F5C5423CEDDA10FCE0E4AD666B8B6484CBDE846AD31AA6AF9D8BD28307",
    "B8824A33A59C6688B8699936F7766AE204D7C36A5F9C5E9F3E4D265FF5615FA7",
    "50036B581888EC5124E8E79282413B55F9D11B8EB8EE791F9F7B4C8C1D1C9D02",
    "E9DF6CCB02A836CB84C88511C0CDA2BF2D00513A867D3EF8C06CDBF68B5F1BA1",
    "2F7BC3F1D062B0A645757A4C9E65DD4D055CDF3CA3923039A847D63A78466D95",
    "7D67D19B3C0376DD72C954BC5B9A2953F04AD21EE842319387A7CE0BF5F37B5A",
    "74CEB8ADD399701CBC9D895E5945C3F0855B37192ABB43D52B53FDC4355205CB",
    "FAAD656AE41C9EE21D547F1769F9733D7C917606C633FD9710373F6908074938",
    "F654C1E360E16824903DA29B96B6EA373CA0B80BC5B03A5D002F8E0F684616DA",
    "5AC7A1D6945DA1FF4EA68941916FFD8438979B0AC323270EF286F6656E2F69C1",
    "5FD84A6B2B877F95A3B8D996CFD143E1F2FC7B11AB9FA8BB250EDEE05A844E8B",
    "68E60F3C8ABAD9EB1E5C75525B7601B502C1A9695CFDC8374F9BE2CE176E38C9",
    "22F4D3E3277701576E9F46C3F7274577EDBD12806449DB95CAEE75F7EAD0D1EA",
    "DB92BFC61C4CDE131C44C4B5707B66FB83E71D5BB71F9D0B42DDAC68639E3EBE",
    "16A82222B33F4A76B7298657F7818885E19F024143953B90A110CD19DE441089",
    "205C287ECFC21F09477B77007B153C7C48FBDCE428D6A793839115E02F93DE97",
    "1C3345D1FB442757B825BDCFAB796637483974874749B4F72FF77EA8D6285160",
    "F1B644182D10E46FDCF96BD4582EA28A81B0DFAC1586BA1BC9909A8FCA799A78",
    "9AA55999A40E32FA07442384F56EC438D73A2D81C31B81177DEE7F18227CEEC5",
    "F8F7D5D5BFEF6CFA1A6BBCA6E9470B2F5CF5797FB43A739FB96691ABEA306121",
    "D37FEC6496BFCBDE28EBE9A4BBB9575BA4859FE270D0272B64809C6332B83AC4",
    "E0E748AD00E9AEA718F88AFF83060D9C2B8A0A59C37C796461C26D3961CD9A4E",
    "7A3AFA78C04F3D14CB501DC5F65BB5E6716DC430B299D794AD1B9C39F387D048",
    "ACD8C7C81B27634D9C654D48A1262D28AA18C4E8A7A9F4EE7EE01401A8133F24",
    "39BC494B3279B312C71D468D8A474D004666FDA1FCDF7307E7DB1218972301D4",
    "D8CCC5593158FC705353E9508A63913770F3F8E16391F5E34DCD4814379A1711",
    "43609A1FBF51B5270ACC485779B198D34483B77BB3AB5BC5942CC2CFFE45F9BD",
    "F4BC98CB643E55C96FF8BB51829C788DD2BADF93367240AFB579782E689FFE2A",
    "1DD41C4AA825F51868CF04F2E305DB858B462044528DD729E7B4818AD53D8C75",
    "38B2E39E8F9A663BEF9C2E4F77F184523AC113EB9081E357011CCB40C7436E83",
    "343B86DC7B9BCACDB530B759A0387D24980B804907C6872D62933007A34EFD30",
    "A8E751F96A8A14DAB70FC8FD3D5226EE832751B9C0E8B6FDEC129BCC48B315ED",
    "AD2F7F939C1941BC6209FCA347F64ED533756964411009B6B253FA94C9AF47C9",
    "6E698BD7125EBF35B82DC3B4AC23C28B60FC04B818927B89987A2F2656D623F6",
    "D89E70E6AF40BCA2683C9CFA418C42A7A584AD6540934E3CA693483E5C6015AA",
    "D181977F02E488518B42F98C11BCF70327E346FE6FCB328576D0167E98DA3A28",
    "061D791750B11EE10E7A0B34AD62B659C46DFE39529201BAED2D911BB3585043",
    "0509DE8FDF43E38FB5F872D9425E85D7FE15969FF8C47412164BE4A4E32C52D7",
    "20CA47945CD90DFDE4EBC7BB52A2F184BB1A2F89333D51360CDEC6DADAA56E81",
    "AB1F99203337002F1DB5B259C897A8250C5FE04FD7DD7D32E4DA49D8ED4547C6",
    "025BDBBA4843943451F012C664EF0D6148DBFE607BE2CE7B2789E965EBC4CF69",
    "D60608CFE58AE7B189960C2C966B9D229C4C1CAD40A879F7D11BCD035A29A47D",
    "A6D6EAAA0D48E0CD99C5D6A7D15A516425ABEC5D5CC499560EB528886FE50A58",
    "3B4057E35CB03997E34A498B9C93BA4537E09483E1D332AEAB72127FF246B42F",
    "274B14EE4D9CFD426938DAB84D088AED08146196BB17FB452EADBFBAFF01EFA3",
    "DB9FBEB2F373EC46F5AEAF9D43F77BE32B4EF0ADFEAA51ADFD314B7428033E2B",
    "26E663ACEA301CAD32711F25E8589A882B15752A180058E265CE32B0FA29B670",
    "469915F4DA89F3D066650408FA0FE47B78F4934A1DA8C6BF5A975C40ED1D111E",
    "E5DADD90378587E9C4A9AAEDE6DFD1BBF4AF00811AC7056FF1B6F406A8F576B8",
    "D313DEED630C822126CD56B5F6723F6C0BCEE289D310958E5C2C340924F0860A",
    "3125C4D1FF76629AEF96190364C938D258CBF84408F36D08820D9BCAD6162A06",
    "E75B18AE5AD1FF71833BEEB579A82AA3A6AF0C78DE283191816138022F06AC65",
    "042F9B07BA244B57DDA36123F1E9978BCCDC155A0D18B5A9EFA7094B5F86D114",
    "87D77EFA870EAC6CCAA13903C27C6D220F1285DCC51A4A452CDCD69DA7080883",
    "9D643A070AFC0F1924ED5FBD5DF9CC1808458B7A0C50C5F34118EAF04E8B706C",
    "B61FC5FDD656D96D4D9D110E6EDB0F7C5DFE2386DD7EE976F8A92FE7561F17B6",
    "B1CC3CCA08D51B6C9BBAD9A3434FBB717D6F1CCAA8D2D0353B1E5A3C37A3A0C0",
    "DF4F34630616FD49D5CC1A44833418D8C068AC0AE28BBCA77C0B800A09C8E57A",
    "15A9C1B2EC519346C9C84F9F9B023000A9DA2143FA5375F445CC277742D54494",
    "A6A518EA56E0C5F30911D98D941CE9CCAC7190EF53E539CB752123D098081182",
    "010D7B430294DDCA18538E3571B3359A92680A3FB32598CC263CCBEECC9A7382",
    "FC113290F348E7FCBC90263496DCB30E73F2F36B66A1E8D028F685CDA6E3273C",
    "CD3B7D591C944BC72F92D730DF54E1F826729FE79FBC6ABFA32C0AFA4958E96C",
    "AEFBBB36DD882A83308F2CDC6F3EB41C68147D8083AA2E0B838AD9FD3C8AF998",
    "81006D660875D2AB1D3EC5D5F6992894DF7254C2E697D9361830F972EEF3628C",
    "B794A3399388591BD4F5E4B593F6E9E5C077099F1B20FCB78E96D99F8A37058F",
    "382FCBFEF21C970F25C959F22F436DDC42209AB2D83E4770B026C9D952AE85E2",
    "11F6306BBFCE866E730EE49CE77EA25CB09BA8F9BAF6A8B43DA41F8204B94740",
    "2DCE3D3BA5C800B99AFC4ABF3EDDCBB2889B448AE46DDA41867F74CF270723B5",
    "596B5C40DCDE7336ECF155FB31F9A20DCC304891A5E7EDCF121051B5C5E3FD96",
    "C2CB12685B1D8EFFD455EE4C86DE895A1C57647162A891184B7FACD42F41514C",
    "5C0D896B41DE72178ACE5E3FCE9F7B74977B3504BE3727FA3B495166ECCD3EBA",
    "281D4BB10A36DE09F9F8CE4B0948F52AC3B2962A0B33DD2D1DAD64F575665A14",
    "0E6DE79E39ED7C2BC7BBBBA7FF9851E4F04CBACDD5DEE45CBC07BD7D5D04A8E4",
    "128779D520A4C81218896F54A2DBE140570801C228F6012AF92E2974F1E2DB6A",
    "E57B964EEB264945C4C133912A61FBBBB793D697B5CF76A5C4AC97341A2659B2",
    "A9D04F0A18E6F20980A75DFC32E37949B16DC5156FD21313F1A3BB3C42EC9BA9",
};

int verify_int(const char *hash_str)
{
    for (int i = 0; i < sizeof(valid_hashes) / sizeof(valid_hashes[0]); i++)
    {
        if (strcmp(hash_str, valid_hashes[i]) == 0)
            return 1;
    }
    return 0;
}

typedef struct
{
    char file_path[MAX_PATH];
    char hash[65]; // SHA-256 hash string
} InvalidHash;

InvalidHash *invalid_hashes = NULL;
size_t invalid_count = 0;
size_t invalid_capacity = 0;

void record_invalid_hash(const char *file_path, const char *hash_hex)
{
    printf("[DEBUG] Recording invalid hash: %s\n", file_path);
    if (invalid_count >= invalid_capacity)
    {
        invalid_capacity = (invalid_capacity == 0) ? INITIAL_INVALIDS : invalid_capacity * 2;
        invalid_hashes = realloc(invalid_hashes, invalid_capacity * sizeof(InvalidHash));
        if (!invalid_hashes)
        {
            perror("realloc failed");
            exit(EXIT_FAILURE);
        }
    }

    strncpy(invalid_hashes[invalid_count].file_path, file_path, MAX_PATH - 1);
    invalid_hashes[invalid_count].file_path[MAX_PATH - 1] = '\0';

    strncpy(invalid_hashes[invalid_count].hash, hash_hex, 64);
    invalid_hashes[invalid_count].hash[64] = '\0';

    invalid_count++;
}

void report_invalid_hashes()
{
    if (invalid_count == 0)
    {
        send_webhook(NULL, "All file hashes are valid.", 65280, "File Hash Check");
        return;
    }

    send_webhook(NULL, "user has invalid file hashes", 16711680, "Invalid File Hashes");
}

void hash_file(const char *file_path)
{
    FILE *file = fopen(file_path, "rb");
    if (!file)
    {
        perror("File open failed");
        return;
    }

    unsigned char buffer[8192];
    unsigned char hash[SHA256_DIGEST_LENGTH];
    SHA256_CTX ctx;
    size_t bytes;

    SHA256_Init(&ctx);
    while ((bytes = fread(buffer, 1, sizeof(buffer), file)) > 0)
    {
        SHA256_Update(&ctx, buffer, bytes);
    }
    SHA256_Final(hash, &ctx);
    fclose(file);

    char hash_hex[65];
    for (int i = 0; i < SHA256_DIGEST_LENGTH; i++)
        sprintf(&hash_hex[i * 2], "%02X", hash[i]);

    if (!verify_int(hash_hex))
    {
        record_invalid_hash(file_path, hash_hex);
    }
}
void scan_dir(const char *directory)
{
    char search_path[MAX_PATH];
    snprintf(search_path, sizeof(search_path), "%s\\*.dll", directory);

    WIN32_FIND_DATAA find_data;
    HANDLE hFind = FindFirstFileA(search_path, &find_data);

    if (hFind == INVALID_HANDLE_VALUE)
    {
        fprintf(stderr, "No DLL files found in: %s\n", directory);
        return;
    }

    do
    {
        char full_path[MAX_PATH];
        snprintf(full_path, sizeof(full_path), "%s\\%s", directory, find_data.cFileName);
        hash_file(full_path);
    } while (FindNextFileA(hFind, &find_data));

    FindClose(hFind);
}
